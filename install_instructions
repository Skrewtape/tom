This document assumes you are running on a ubuntu 15 machine

BACKEND
---
## run the following commands
apt-get install virtualenv
virtualenv venv
source venv/bin/activate
apt-get install aptitude
apt-get install postgresql-9.5
apt-get install postgresql-client-9.5
apt-get install postgresql-server-dev-9.5
apt-get install gcc
apt-get install python-psycopg2
apt-get install python2.7-dev
apt-get install apache2
apt-get install gunicorn
sudo su - postgres
psql -c "CREATE USER tom WITH PASSWORD 'tomPassword'; create database tom_server; GRANT ALL PRIVILEGES ON DATABASE tom_server to tom;"
psql tom_server -c "CREATE FUNCTION testing_papa_scoring(rank real) RETURNS real AS \$\$ BEGIN IF rank = 1 THEN RETURN 100; ELSIF rank = 2 THEN RETURN 90; ELSIF rank = 3 THEN RETURN 85; ELSIF rank < 88 THEN  RETURN 100-rank-12; ELSIF rank >= 88 THEN RETURN 0; END IF; END; \$\$ LANGUAGE plpgsql;"
psql tom_server -c "CREATE FUNCTION finals_papa_scoring(rank real) RETURNS real AS \$\$  BEGIN IF rank = 1 THEN RETURN 3; ELSIF rank = 2 THEN RETURN 2; ELSIF rank = 3 THEN RETURN 1; ELSIF rank = 4 THEN RETURN 0; END IF; END; \$\$ LANGUAGE plsgsql;"
export DATABASE_URL=postgres://postgres:tom:tomPassword@localhost/tom_server
python ./setup.py
cd <tom_directory>/back
export PYTHONPATH=`pwd`
cd utils
ptyhon ./seed_db.py

FRONTEND
---
apt-get install npm
apt-get install nodejs-legacy
apt-get install ruby-compass
npm install
./node_modules/bower/bin/bower --allow-root install
./node_modules/grunt-cli/bin/grunt


SETTING UP DB REPLICATION (optional)
---
## create replication user on server :
sudo -u postgres psql -c "CREATE USER replicator REPLICATION LOGIN ENCRYPTED PASSWORD 'thepassword';"
## edit postgres configs on the server:
-postgresql.conf :
listen_addresses = '<replication_machine_ip>'
wal_level = hot_standby
max_wal_senders = 5
wal_keep_segments = 32
archive_mode    = on
archive_command = 'cp %p /path_to/archive/%f'

-pg_hba.conf:
# TYPE  DATABASE        USER            ADDRESS                 METHOD
  host  replication     replication     <replication_machine_ip>/32         md5
##postgres replication script (on replicated machine):

-run the following command on the replication machine :
<path_to_tom>/back/util/start_replication.sh <ip_of_server>

